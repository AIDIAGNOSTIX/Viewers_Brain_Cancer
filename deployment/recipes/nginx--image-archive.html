
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Nginx + Image Archive Â· OHIF</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-versions/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-theme-cornerstone/cornerstone.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="user-account-control.html" />
    
    
    <link rel="prev" href="static-assets.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                



<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../our-process.html">
            
                <a href="../../our-process.html">
            
                    
                    Our Process
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Development
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../development/getting-started.html">
            
                <a href="../../development/getting-started.html">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../development/contributing.html">
            
                <a href="../../development/contributing.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../development/continous-integration.html">
            
                <a href="../../development/continous-integration.html">
            
                    
                    Continuous Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../../development/testing.html">
            
                <a href="../../development/testing.html">
            
                    
                    Testing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../configuring/">
            
                <a href="../../configuring/">
            
                    
                    Configuring
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../configuring/data-source.html">
            
                <a href="../../configuring/data-source.html">
            
                    
                    Data Source
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../../architecture/">
            
                <a href="../../architecture/">
            
                    
                    Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../../viewer/">
            
                <a href="../../viewer/">
            
                    
                    Viewer
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="../../viewer/configuration.html">
            
                <a href="../../viewer/configuration.html">
            
                    
                    Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="../../viewer/themeing.html">
            
                <a href="../../viewer/themeing.html">
            
                    
                    Themeing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.3" data-path="../../viewer/internationalization.html">
            
                <a href="../../viewer/internationalization.html">
            
                    
                    Internationalization
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../../extensions/">
            
                <a href="../../extensions/">
            
                    
                    Extensions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="../../extensions/">
            
                <a href="../../extensions/#registering-an-extension">
            
                    
                    Registering
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="../../extensions/">
            
                <a href="../../extensions/#lifecycle-hooks">
            
                    
                    Lifecycle Hooks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.2.1" data-path="../../extensions/lifecycle/pre-registration.html">
            
                <a href="../../extensions/lifecycle/pre-registration.html">
            
                    
                    preRegistration
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3.3" data-path="../../extensions/">
            
                <a href="../../extensions/#modules">
            
                    
                    Modules
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.3.1" data-path="../../extensions/modules/commands.html">
            
                <a href="../../extensions/modules/commands.html">
            
                    
                    Commands
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3.2" data-path="../../extensions/modules/panel.html">
            
                <a href="../../extensions/modules/panel.html">
            
                    
                    Panel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3.3" data-path="../../extensions/modules/sop-class-handler.html">
            
                <a href="../../extensions/modules/sop-class-handler.html">
            
                    
                    SOP Class Handler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3.4" data-path="../../extensions/modules/toolbar.html">
            
                <a href="../../extensions/modules/toolbar.html">
            
                    
                    Toolbar
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3.5" data-path="../../extensions/modules/viewport.html">
            
                <a href="../../extensions/modules/viewport.html">
            
                    
                    Viewport
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3.4" data-path="../../extensions/">
            
                <a href="../../extensions/#contexts">
            
                    
                    Contexts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.5" data-path="../../extensions/">
            
                <a href="../../extensions/#extensionmanager">
            
                    
                    ExtensionManager
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.6" data-path="../../extensions/">
            
                <a href="../../extensions/#maintained-extensions">
            
                    
                    OHIF Maintained
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../../services/">
            
                <a href="../../services/">
            
                    
                    Services
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1" data-path="../../services/default/">
            
                <a href="../../services/default/">
            
                    
                    Default
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2" data-path="../../services/ui/">
            
                <a href="../../services/ui/">
            
                    
                    UI
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.2.1" data-path="../../services/ui/ui-dialog-service.html">
            
                <a href="../../services/ui/ui-dialog-service.html">
            
                    
                    Dialog Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2.2" data-path="../../services/ui/ui-modal-service.html">
            
                <a href="../../services/ui/ui-modal-service.html">
            
                    
                    Modal Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2.3" data-path="../../services/ui/ui-notification-service.html">
            
                <a href="../../services/ui/ui-notification-service.html">
            
                    
                    Notification Service
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../">
            
                <a href="../">
            
                    
                    Deployment
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../">
            
                <a href="../#embedded-viewer">
            
                    
                    Embedded
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../">
            
                <a href="../#stand-alone-viewer">
            
                    
                    Stand-alone
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="../">
            
                <a href="../#data">
            
                    
                    Data
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2" >
            
                <span>
            
                    
                    Recipes
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" >
            
                <span>
            
                    
                    Script Include
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1.1" data-path="embedded-viewer.html">
            
                <a href="embedded-viewer.html">
            
                    
                    Embedding the Viewer
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2.2" >
            
                <span>
            
                    
                    Stand-Alone
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.2.1" data-path="build-for-production.html">
            
                <a href="build-for-production.html">
            
                    
                    Build for Production
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.2.2" data-path="static-assets.html">
            
                <a href="static-assets.html">
            
                    
                    Static
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.2.2.3" data-path="nginx--image-archive.html">
            
                <a href="nginx--image-archive.html">
            
                    
                    Nginx + Image Archive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.2.4" data-path="user-account-control.html">
            
                <a href="user-account-control.html">
            
                    
                    User Account Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.2.5" data-path="../../connecting-to-image-archives/google-cloud-healthcare.html">
            
                <a href="../../connecting-to-image-archives/google-cloud-healthcare.html">
            
                    
                    Google Cloud Healthcare
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../../faq/">
            
                <a href="../../faq/">
            
                    
                    FAQ
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../../faq/scope-of-project.html">
            
                <a href="../../faq/scope-of-project.html">
            
                    
                    Scope of Project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="../../faq/browser-support.html">
            
                <a href="../../faq/browser-support.html">
            
                    
                    Browser Support
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="../../faq/pwa-vs-packaged.html">
            
                <a href="../../faq/pwa-vs-packaged.html">
            
                    
                    PWA vs Packaged
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../../help.html">
            
                <a href="../../help.html">
            
                    
                    Help
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>



                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
  
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Nginx + Image Archive</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="nginx--image-archive"><a name="nginx--image-archive" class="plugin-anchor" href="#nginx--image-archive"><i class="fa fa-link" aria-hidden="true"></i></a>Nginx + Image Archive</h1>
<blockquote>
<p>DISCLAIMER! We make no claims or guarantees of this approach&apos;s security. If in
doubt, enlist the help of an expert and conduct proper audits.</p>
</blockquote>
<p>At a certain point, you may want others to have access to your instance of the
OHIF Viewer and its medical imaging data. This post covers one of many potential
setups that accomplish that. Please note, noticably absent is user account
control.</p>
<blockquote>
<p><strong>Do not use this recipe to host sensitive medical data on the open web!</strong> </p>
</blockquote>
<p>Depending
on your company&apos;s policies, this may be an appropriate setup on an internal
network when protected with a server&apos;s basic authentication. For a more robust
setup, check out our <a href="user-account-control.html">user account control recipe</a>
that builds on the lessons learned here.</p>
<h2 id="overview"><a name="overview" class="plugin-anchor" href="#overview"><i class="fa fa-link" aria-hidden="true"></i></a>Overview</h2>
<p>Our two biggest hurdles when hosting our image archive and web client are:</p>
<ul>
<li>Risks related to exposing our PACS to the netowrk</li>
<li>Cross-Origin Resource Sharing (CORS) requests</li>
</ul>
<h3 id="handling-web-requests"><a name="handling-web-requests" class="plugin-anchor" href="#handling-web-requests"><i class="fa fa-link" aria-hidden="true"></i></a>Handling Web Requests</h3>
<p>We mitigate our first issue by allowing <a href="https://www.nginx.com/resources/glossary/nginx/" target="_blank">Nginx</a> to handle incoming web
requests. Nginx is open source software for web serving, reverse proxying,
caching, and more. It&apos;s designed for maximum performance and stability --
allowing us to more reliably serve content than Orthanc&apos;s built-in server can.</p>
<p>More specifically, we accomplish this by using a
<a href="https://en.wikipedia.org/wiki/Reverse_proxy" target="_blank"><code>reverse proxy</code></a> to retrieve 
resources from our image archive (Orthanc), and when accessing its web admin.</p>
<blockquote>
<p>A reverse proxy is a type of proxy server that retrieves resources on behalf
of a client from one or more servers. These resources are then returned to the
client, appearing as if they originated from the proxy server itself.</p>
</blockquote>
<h3 id="cors-issues"><a name="cors-issues" class="plugin-anchor" href="#cors-issues"><i class="fa fa-link" aria-hidden="true"></i></a>CORS Issues</h3>
<p><a href="https://medium.com/@baphemot/understanding-cors-18ad6b478e2b" target="_blank">Cross-Origin Resource Sharing</a> (CORS) is a mechanism that uses HTTP headers to
tell a browser which web applications have permission to access selected
resources from a server at a different origin (domain, protocol, port). IE. By
default, a Web App located at <code>http://my-website.com</code> can&apos;t access resources
hosted at <code>http://not-my-website.com</code></p>
<p>We can solve this one of two ways:</p>
<ol>
<li>Have our Image Archive located at the same domain as our Web App</li>
<li>Add appropriate <code>Access-Control-Allow-*</code> HTTP headers</li>
</ol>
<p><strong>This solution uses the first approach.</strong></p>
<h3 id="diagram"><a name="diagram" class="plugin-anchor" href="#diagram"><i class="fa fa-link" aria-hidden="true"></i></a>Diagram</h3>
<p>This setup allows us to create a setup similar to the one pictured below:</p>
<div style="text-align: center;">
  <img src="../../assets/img/nginx-image-archive.png" alt="request flow example" style="margin: 0 auto;">
  <div><i>simplified request flow diagram</i></div>
</div>


<ul>
<li>All web requests are routed through <code>nginx</code> on our <code>OpenResty</code> image</li>
<li><code>/pacs</code> is a reverse proxy for <code>orthanc</code>&apos;s <code>DICOM Web</code> endpoints</li>
<li><code>/pacs-admin</code> is a reverse proxy for <code>orthanc</code>&apos;s Web Admin</li>
<li>All static resources for OHIF Viewer are served up by <code>nginx</code> when a matching
route for that resource is requested</li>
</ul>
<h2 id="getting-started"><a name="getting-started" class="plugin-anchor" href="#getting-started"><i class="fa fa-link" aria-hidden="true"></i></a>Getting Started</h2>
<h3 id="requirements"><a name="requirements" class="plugin-anchor" href="#requirements"><i class="fa fa-link" aria-hidden="true"></i></a>Requirements</h3>
<ul>
<li>Docker<ul>
<li><a href="https://docs.docker.com/docker-for-mac/" target="_blank">Docker for Mac</a></li>
<li><a href="https://docs.docker.com/docker-for-windows/" target="_blank">Docker for Windows</a></li>
</ul>
</li>
<li>Node 16.x with optional Python and Visual Studio Build Tools (<a href="https://github.com/webpack/webpack/issues/14532" target="_blank">webpack 4 has an issue</a> with Node 17.x)<ul>
<li><a href="https://nodejs.org/en/download/" target="_blank">Node.js</a></li>
</ul>
</li>
</ul>
<p><em>Not sure if you have <code>docker</code> installed already? Try running <code>docker --version</code>
in command prompt or terminal</em></p>
<h3 id="setup"><a name="setup" class="plugin-anchor" href="#setup"><i class="fa fa-link" aria-hidden="true"></i></a>Setup</h3>
<p><em>Spin Things Up</em></p>
<ul>
<li>Navigate to <code>./platform/viewer/.recipes/OpenResty-Orthanc</code> in your shell</li>
<li>Run <code>docker-compose up</code></li>
</ul>
<p><em>Upload Your First Study</em></p>
<ul>
<li>Navigate to <code>http://127.0.0.1/pacs-admin</code></li>
<li>From the top right, select &quot;Upload&quot;</li>
<li>Click &quot;Select files to upload...&quot; (DICOM)</li>
<li>Click &quot;Start the upload&quot;</li>
<li>Navigate back to <code>http://127.0.0.1/</code> to view your studies in the Study List</li>
</ul>
<h3 id="troubleshooting"><a name="troubleshooting" class="plugin-anchor" href="#troubleshooting"><i class="fa fa-link" aria-hidden="true"></i></a>Troubleshooting</h3>
<h4 id="exit-code-137"><a name="exit-code-137" class="plugin-anchor" href="#exit-code-137"><i class="fa fa-link" aria-hidden="true"></i></a>Exit code 137</h4>
<p>This means Docker ran out of memory. Open Docker Desktop, go to the <code>advanced</code>
tab, and increase the amount of Memory available.</p>
<h4 id="cannot-create-container-for-service-x"><a name="cannot-create-container-for-service-x" class="plugin-anchor" href="#cannot-create-container-for-service-x"><i class="fa fa-link" aria-hidden="true"></i></a>Cannot create container for service X</h4>
<p>Use this one with caution: <code>docker system prune</code></p>
<h4 id="x-is-already-running"><a name="x-is-already-running" class="plugin-anchor" href="#x-is-already-running"><i class="fa fa-link" aria-hidden="true"></i></a>X is already running</h4>
<p>Stop running all containers:</p>
<ul>
<li>Win: <code>docker ps -a -q | ForEach { docker stop $_ }</code></li>
<li>Linux: <code>docker stop $(docker ps -a -q)</code></li>
</ul>
<h3 id="configuration"><a name="configuration" class="plugin-anchor" href="#configuration"><i class="fa fa-link" aria-hidden="true"></i></a>Configuration</h3>
<p>After verifying that everything runs with default configuration values, you will
likely want to update:</p>
<ul>
<li>The domain: <code>http://127.0.0.1</code></li>
</ul>
<h4 id="ohif-viewer"><a name="ohif-viewer" class="plugin-anchor" href="#ohif-viewer"><i class="fa fa-link" aria-hidden="true"></i></a>OHIF Viewer</h4>
<p>The OHIF Viewer&apos;s configuration is imported from a static <code>.js</code> file. The
configuration we use is set to <a href="https://github.com/OHIF/Viewers/blob/master/platform/viewer/public/config/docker_openresty-orthanc.js" target="_blank">a specific file</a> when we build the viewer, and
determined by the env variable: <code>APP_CONFIG</code>. You can see where we set its value
in the <code>dockerfile</code> for this solution:</p>
<p><code>ENV APP_CONFIG=config/docker_openresty-orthanc.js</code></p>
<p>To rebuild the <code>webapp</code> image created by our <code>dockerfile</code> after updating the
Viewer&apos;s configuration, you can run:</p>
<ul>
<li><code>docker-compose build</code> OR</li>
<li><code>docker-compose up --build</code></li>
</ul>
<h4 id="other"><a name="other" class="plugin-anchor" href="#other"><i class="fa fa-link" aria-hidden="true"></i></a>Other</h4>
<p>All other files in this directory include</p>
<table>
<thead>
<tr>
<th>Service</th>
<th>Configuration</th>
<th>Docs</th>
</tr>
</thead>
<tbody>
<tr>
<td>OHIF Viewer</td>
<td><a href="https://github.com/OHIF/Viewers/blob/master/platform/viewer/.recipes/OpenResty-Orthanc/dockerfile" target="_blank">dockerfile</a></td>
<td>You&apos;re reading them now!</td>
</tr>
<tr>
<td>OpenResty (Nginx)</td>
<td><a href="https://github.com/OHIF/Viewers/blob/master/platform/viewer/.recipes/OpenResty-Orthanc/config/nginx.conf" target="_blank"><code>/nginx.conf</code></a></td>
<td><a href="https://github.com/zmartzone/lua-resty-openidc" target="_blank">lua-resty-openidc</a></td>
</tr>
<tr>
<td>Orthanc</td>
<td><a href="https://github.com/OHIF/Viewers/blob/master/platform/viewer/.recipes/OpenResty-Orthanc/config/orthanc.json" target="_blank"><code>/orthanc.json</code></a></td>
<td><a href="http://book.orthanc-server.com/users/configuration.html#configuration" target="_blank">Here</a></td>
</tr>
</tbody>
</table>
<h2 id="next-steps"><a name="next-steps" class="plugin-anchor" href="#next-steps"><i class="fa fa-link" aria-hidden="true"></i></a>Next Steps</h2>
<h3 id="deploying-to-production"><a name="deploying-to-production" class="plugin-anchor" href="#deploying-to-production"><i class="fa fa-link" aria-hidden="true"></i></a>Deploying to Production</h3>
<p>While these configuration and docker-compose files model an environment suitable
for production, they are not easy to deploy &quot;as is&quot;. You can either:</p>
<ul>
<li>Manually recreate this environment and deploy built application files <strong>OR</strong></li>
<li>Deploy to a cloud kubernetes provider like
<a href="https://www.digitalocean.com/products/kubernetes/" target="_blank">Digital Ocean</a> <strong>OR</strong><ul>
<li><a href="https://landscape.cncf.io/category=cloud&amp;format=card-mode&amp;grouping=category" target="_blank">See a full list of cloud providers here</a></li>
</ul>
</li>
<li>Find and follow your preferred provider&apos;s guide on setting up
<a href="https://docs.docker.com/get-started/" target="_blank">swarms and stacks</a></li>
</ul>
<h3 id="adding-ssl"><a name="adding-ssl" class="plugin-anchor" href="#adding-ssl"><i class="fa fa-link" aria-hidden="true"></i></a>Adding SSL</h3>
<p>Adding SSL registration and renewal for your domain with Let&apos;s Encrypt that
terminates at Nginx is an incredibly important step toward securing your data.
Here are some resources, specific to this setup, that may be helpful:</p>
<ul>
<li><a href="https://github.com/GUI/lua-resty-auto-ssl" target="_blank">lua-resty-auto-ssl</a></li>
<li><a href="https://www.nginx.com/blog/using-free-ssltls-certificates-from-lets-encrypt-with-nginx/" target="_blank">Let&apos;s Encrypt + Nginx</a></li>
</ul>
<p>While we terminate SSL at Nginx, it may be worth using self signed certificates
for communication between services.</p>
<ul>
<li><a href="https://docs.nginx.com/nginx/admin-guide/security-controls/terminating-ssl-tcp/" target="_blank">SSL Termination for TCP Upstream Servers</a></li>
</ul>
<h3 id="use-postgressql-w-orthanc"><a name="use-postgressql-w-orthanc" class="plugin-anchor" href="#use-postgressql-w-orthanc"><i class="fa fa-link" aria-hidden="true"></i></a>Use PostgresSQL w/ Orthanc</h3>
<p>Orthanc can handle a large amount of data and requests, but if you find that
requests start to slow as you add more and more studies, you may want to
configure your Orthanc instance to use PostgresSQL. Instructions on how to do
that can be found in the
<a href="http://book.orthanc-server.com/users/docker.html" target="_blank"><code>Orthanc Server Book</code></a>, under
&quot;PostgreSQL and Orthanc inside Docker&quot;</p>
<h3 id="improving-this-guide"><a name="improving-this-guide" class="plugin-anchor" href="#improving-this-guide"><i class="fa fa-link" aria-hidden="true"></i></a>Improving This Guide</h3>
<p>Here are some improvements this guide would benefit from, and that we would be
more than happy to accept Pull Requests for:</p>
<ul>
<li>SSL Support</li>
<li>Complete configuration with <code>.env</code> file (or something similar)</li>
<li>Any security issues</li>
<li>One-click deploy to a cloud provider</li>
</ul>
<h2 id="resources"><a name="resources" class="plugin-anchor" href="#resources"><i class="fa fa-link" aria-hidden="true"></i></a>Resources</h2>
<h3 id="misc-helpful-commands"><a name="misc-helpful-commands" class="plugin-anchor" href="#misc-helpful-commands"><i class="fa fa-link" aria-hidden="true"></i></a>Misc. Helpful Commands</h3>
<p><em>Check if <code>nginx.conf</code> is valid:</em></p>
<pre><code class="lang-bash">docker run --rm -t <span class="hljs-_">-a</span> stdout --name my-openresty -v <span class="hljs-variable">$PWD</span>/config/:/usr/<span class="hljs-built_in">local</span>/openresty/nginx/conf/:ro openresty/openresty:alpine-fat openresty -c /usr/<span class="hljs-built_in">local</span>/openresty/nginx/conf/nginx.conf -t
</code></pre>
<p><em>Interact w/ running container:</em></p>
<p><code>docker exec -it CONTAINER_NAME bash</code></p>
<p><em>List running containers:</em></p>
<p><code>docker ps</code></p>
<h3 id="referenced-articles"><a name="referenced-articles" class="plugin-anchor" href="#referenced-articles"><i class="fa fa-link" aria-hidden="true"></i></a>Referenced Articles</h3>
<p>For more documentation on the software we&apos;ve chosen to use, you may find the
following resources helpful:</p>
<ul>
<li><a href="http://book.orthanc-server.com/users/docker.html" target="_blank">Orthanc for Docker</a></li>
<li><a href="http://www.staticshin.com/programming/definitely-an-open-resty-guide/" target="_blank">OpenResty Guide</a></li>
<li><a href="https://openresty-reference.readthedocs.io/en/latest/Lua_Nginx_API/" target="_blank">Lua Ngx API</a></li>
</ul>
<p>For a different take on this setup, check out the repositories our community
members put together:</p>
<ul>
<li><a href="https://github.com/mjstealey/ohif-orthanc-dimse-docker" target="_blank">mjstealey/ohif-orthanc-dimse-docker</a></li>
<li><a href="https://github.com/trypag/ohif-orthanc-postgres-docker" target="_blank">trypag/ohif-orthanc-postgres-docker</a></li>
</ul>
<!--
  Links
  -->
<!-- prettier-ignore-start -->
<!-- DOCS -->
<!-- SRC -->
<!-- prettier-ignore-end -->

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                

            </div>

            
                
                <a href="static-assets.html" class="navigation navigation-prev " aria-label="Previous page: Static">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="user-account-control.html" class="navigation navigation-next " aria-label="Next page: User Account Control">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Nginx + Image Archive","level":"3.2.2.3","depth":3,"next":{"title":"User Account Control","level":"3.2.2.4","depth":3,"path":"deployment/recipes/user-account-control.md","ref":"deployment/recipes/user-account-control.md","articles":[]},"previous":{"title":"Static","level":"3.2.2.2","depth":3,"path":"deployment/recipes/static-assets.md","ref":"deployment/recipes/static-assets.md","articles":[]},"dir":"ltr"},"config":{"plugins":["edit-link","theme-cornerstone","-fontsettings","github","ga","anchors","versions"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"github":{"url":"https://github.com/OHIF/Viewers"},"search":{},"theme-cornerstone":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"highlight":{},"sitemap":{"hostname":"https://docs.ohif.org","todo":"sitemap plugin removed; causing build errors"},"ga":{"configuration":"auto","token":"UA-110573590-2"},"versions":{"type":"branches","gitbookConfigURL":"https://raw.githubusercontent.com/OHIF/Viewers/master/docs/book.json","options":[{"value":"https://docs.ohif.org/history/v1/","text":"Version 1.0.0 (Meteor)"},{"value":"https://docs.ohif.org/","text":"Version 2.0.0","selected":true}]},"sharing":{"facebook":false,"twitter":false,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit This Page","base":"https://github.com/OHIF/Viewers/edit/master/docs"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"OHIF","links":{"sharing":{"facebook":false,"twitter":false}},"gitbook":">3.0.0","description":"Documentation for the OHIF framework"},"file":{"path":"deployment/recipes/nginx--image-archive.md","mtime":"2022-11-12T16:01:55.961Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-11-12T16:02:34.604Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-versions/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    

    </body>
</html>

